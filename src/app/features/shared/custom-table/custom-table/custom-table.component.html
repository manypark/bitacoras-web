<div class="overflow-x-auto rounded-box shadow-md border border-gray-100">
  <table class="table">
    <caption>{{ caption }}</caption>

    <thead>
      <tr>
        @for (col of columns(); track $index) {
          <th>
            <span class="ml-2 text-gray-400">
              {{ col.header }}
            </span>
          </th>
        }
        @if ( showActions() ) {
          <th class="text-gray-400">Acciones</th>
        }
      </tr>
    </thead>

    <tbody>
      @if (isLoading()) {
        @for (i of [1,2,3,4,5]; track i) {
          <tr>
            <td>
              <div class="h-4 w-8 rounded-md bg-gradient-to-r from-gray-200 via-gray-300 to-gray-200 animate-shimmer"></div>
            </td>
            <td>
              <div class="h-4 w-40 rounded-md bg-gradient-to-r from-gray-200 via-gray-300 to-gray-200 animate-shimmer"></div>
            </td>
            <td>
              <div class="h-4 w-24 rounded-md bg-gradient-to-r from-gray-200 via-gray-300 to-gray-200 animate-shimmer"></div>
            </td>
            <td>
              <div class="flex gap-2 justify-center">
                <div class="h-6 w-6 rounded-md bg-gradient-to-r from-gray-200 via-gray-300 to-gray-200 animate-shimmer"></div>
              </div>
            </td>
          </tr>
        }
      }

      @for (row of data; track $index) {
        <tr class="border-y border-gray-200">
          @for (col of columns(); track $index) {
            @let cell = getValueByPath(row, col.key);
            <td>
              @switch (col.type) {
                @case ('date') {
                  <span class="badge badge-ghost p-4">{{ cell | date:'mediumDate' }}</span>
                }
                @case ('image') {
                  @if (cell != '' ) {
                    <div class="avatar">
                      <div class="w-24">
                        <img ngSrc="{{cell}}" fill alt="Log image" class="rounded-xl" priority/>
                      </div>
                    </div>
                  } @else {
                    <div class="avatar avatar-placeholder">
                      <div class="bg-neutral text-neutral-content w-24 rounded-full">
                        <span class="text-3xl"> U </span>
                      </div>
                    </div>
                  }
                }
                @case ('link') {
                  @if (cell > 0) {
                    <a class="link ml-2 bg-gray-200 p-2 rounded-md"> {{ cell }} </a>
                  } @else {
                    <span class="ml-2 bg-gray-200 p-2 rounded-md">{{ formatDisplay(cell) }}</span>
                  }
                }
                @case ('booleanBadge') {
                  @if (cell) {
                    <span class="text-green-600">Activo</span>
                  } @else {
                    <span class="text-red-600">Inactivo</span>
                  }
                }

                @case ('array') {
                  @for (item of cell; track $index) {
                    <span class="badge badge-ghost p-4 mr-2">{{ item.name }}</span>
                  }
                }

                @default {
                  <span class="ml-2">{{ formatDisplay(cell) }}</span>
                }
              }
            </td>
          }

          @if ( showActions() ) {
            <td>
              <div class="flex gap-x-4">
                <div class="w-6 cursor-pointer" (click)="onAction('edit', row)">
                  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor">
                    <path d="M15.7279 9.57627L14.3137 8.16206L5 17.4758V18.89H6.41421L15.7279 9.57627ZM17.1421 8.16206L18.5563 6.74785L17.1421 5.33363L15.7279 6.74785L17.1421 8.16206ZM7.24264 20.89H3V16.6473L16.435 3.21231C16.8256 2.82179 17.4587 2.82179 17.8492 3.21231L20.6777 6.04074C21.0682 6.43126 21.0682 7.06443 20.6777 7.45495L7.24264 20.89Z"></path>
                  </svg>
                </div>
  
                <div class="w-6 cursor-pointer" (click)="onAction('delete', row)">
                  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor">
                    <path d="M17 6H22V8H20V21C20 21.5523 19.5523 22 19 22H5C4.44772 22 4 21.5523 4 21V8H2V6H7V3C7 2.44772 7.44772 2 8 2H16C16.5523 2 17 2.44772 17 3V6ZM18 8H6V20H18V8ZM9 11H11V17H9V11ZM13 11H15V17H13V11ZM9 4V6H15V4H9Z"></path>
                  </svg>
                </div>
              </div>
            </td>
          }
        </tr>
      }
    </tbody>

    <tfoot>
      <tr>
        <td colspan="3">Total de registros:</td>
        <td>{{ data.length }}</td>
      </tr>
    </tfoot>
  </table>
</div>
